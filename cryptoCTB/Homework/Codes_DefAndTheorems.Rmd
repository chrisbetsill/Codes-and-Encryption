---
title: 'Assignment: Codes: Definitions and Theorems, Due Monday, 11:59pm'
author: "Chris Betsill"
date: "November 21, 2016"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(comment = NA)
library(gmp)
library(cryptoCTB)
```

## 1. Non-Perfect Code

Make up an example of a linear code with 16 code words that isn't perfect. List the 16 code words, and give a generating matrix. 

```{r}
M <- matrix(c(1,0,0,0,1,1,0, 0,1,0,0,1,1,1, 0,0,1,0,0,1,1, 0,0,0,1,1,1,1), nrow=4, byrow=TRUE)
M
C <- generateCode(M)
C
isPerfect(C)
```
## 2. Check bounds

Consider the code generated by the following matrix.
$$
B = \begin{bmatrix} 1 & 0 & 0 & 1 & 1 & 0 \\ 0 & 1 & 0 & 0 & 1 & 1 \\ 0 & 0 & 1 & 1 & 0 & 1 \end{bmatrix}
$$
```{r}
M <- matrix(c(1,0,0,1,1,0, 0,1,0,0,1,1, 0,0,1,1,0,1), nrow=3, byrow=TRUE)
```
a. List all the code words.

```{r}
C <- generateCode(M)
C
```

b. Calculate the code rate of this code.

```{r}
log2(nrow(C))/length(C[1, ])
```

c. Is this code a maximum distance separable (MDS) code? Prove or disprove.
```{r}

M <- nrow(C)
n <- length(C[1, ])
d <- codeDistance(C)
isMDS <-function(){
if(M == 2^(n-d+1))
  return(TRUE)
else{
    return(FALSE)
}
}
isMDS()


```
d. Is this code a perfect code? Prove or disprove.

```{r}
isPerfect(C)
```

## 3. Perfect repetition codes

Prove that a $k$ repetition code is perfect if and only if $k$ is odd.

Repetition codes have two code words, all 0's or all 1's thus $M = 2$.

A code is perfect if $M = \frac{2^k}{\sum_{j=0}^{t} \binom{n}{j}}$

Since $M = 2$, the numerator must be twice the denominator for a repetition code to be perfect.

They have a minimum distance $d = k$

Thus, if $k$ is odd $t = \frac{k-1}{2}$, and if $k$ is even $t = \frac{k}{2} - 1$

So if $k$ is odd, ${\sum_{j=0}^{t} \binom{k}{j}} = 2^{t-1}$ by the binomial theorem.

Thus if, and only if, k is odd, $2 = \frac{2^k}{2^{k-1}}$



## 4. $8 \times 8$ Hadamard code

Here's an $8 \times 8$ Hadamard matrix:

$$
B = \begin{bmatrix} 
1 & 1 & 1 & -1 & 1 & -1 & -1 & -1 \\ 
1 & 1 & -1 & -1 & -1 & 1 & -1 & 1 \\ 
1 & -1 & 1 & 1 & -1 & -1 & -1 & 1 \\ 
1 & -1 & 1 & -1 & -1 & 1 & 1 & -1 \\ 
1 & -1 & -1 & -1 & 1 & -1 & 1 & 1 \\ 
1 & 1 & -1 & 1 & -1 & -1 & 1 & -1 \\ 
1 & -1 & -1 & 1 & 1 & 1 & -1 & -1 \\ 
1 & 1 & 1 & 1 & 1 & 1 & 1 & 1  
\end{bmatrix}
$$

```{r}
B <- matrix(c(1,1,1,0,1,0,0,0, 1,1,0,0,0,1,0,1, 1,0,1,1,0,0,0,1, 1,0,1,0,0,1,1,0, 1,0,0,0,1,0,1,1, 1,1,0,1,0,0,1,0, 1,0,0,1,1,1,0,0, 1,1,1,1,1,1,1,1), nrow=8, byrow=TRUE)
```
a. Is the corresponding $8\times 8$ Hadamard code (with $-1$'s replaced by $0$'s) a linear code? Explain why or why not.

```{r}
isLinear <- function(B){
  vec3 <- vector()
  nrowB <- nrow(B) 
  inv <- vector()
  for(l in 1:length(B[1, ])){
    inv <- c(inv, 1)
  }
  for(j in 1:(nrowB-1)){
    vec1 <- B[j, ]
  for(i in (j+1):nrowB){
    match <- FALSE
    vec2 <- B[i, ]
    vec3 <- as.numeric(xor(vec1, vec2))
    for(k in 1:nrowB){
      if(all(vec3 == B[k, ]) || all((vec3 == xor(inv, B[k, ]) )))
        match <- TRUE
    }
    if(match == FALSE)
      return(FALSE)
  }
  }
  return(TRUE)
}

isLinear(B)
```

This is a linear code, because any two code words added together produce another code word.


b. Is this Hadamard code perfect? Prove or disprove.

```{r}
C <- generateCode(B)
isPerfect(C)
```
